<?xml version="1.0" encoding="UTF-8"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro">

  <xacro:include filename="$(find sushi_bot_description)/urdf/common.xacro" />

  <!-- ※ *がついたパラメータはブロックパラメータ -->

  <xacro:macro name="stanford_robot" params="prefix parent *origin">

    <link name="${prefix}base_link">
      <xacro:default_inertial />
      <visual>
        <origin xyz="0 0 0.05" rpy="0 0 0" />
        <geometry>
          <box size="0.15 0.15 0.01" />
        </geometry>
        <material name="StoglRobotics/Violet" />
      </visual>
      <collision>
        <origin xyz="0 0 0.05" rpy="0 0 0" />
        <geometry>
          <box size="0.15 0.15 0.01" />
        </geometry>
      </collision>
    </link>
    <gazebo reference="${prefix}base_link">
      <material>Gazebo/Orange</material>
    </gazebo>

    <!-- Base link -->
    <link name="${prefix}link_0">
      <inertial>
        <origin xyz="0 0 0.05" rpy="0 0 0" />
        <mass value="1.0" />
        <inertia ixx="0.010" ixy="0.0" ixz="0.0" iyy="0.010" iyz="0.0" izz="0.010" />
      </inertial>
      <visual>
        <origin xyz="0 0 0.05" rpy="0 0 0" />
        <geometry>
          <cylinder radius="0.10" length="0.10" />
        </geometry>
        <material name="Blue" />
      </visual>
      <collision>
        <origin xyz="0 0 0.05" rpy="0 0 0" />
        <geometry>
          <cylinder radius="0.10" length="0.10" />
        </geometry>
      </collision>
    </link>
    <!-- Gazebo material for base link -->
    <gazebo reference="${prefix}link_0">
      <material>Gazebo/Orange</material>
    </gazebo>

    <!-- Joint 1: Revolute about Z, between base_dummy and link_0 -->
    <joint name="${prefix}joint_1" type="revolute">
      <parent link="${prefix}base_link" />
      <child link="${prefix}link_0" />
      <origin xyz="0 0 0" rpy="0 0 0" />
      <axis xyz="0 0 1" />
      <limit effort="50.0" velocity="1.0" lower="-3.1416" upper="3.1416" />
    </joint>

    <!-- Link 1 -->
    <link name="${prefix}link_1">
      <inertial>
        <origin xyz="0 0 0.15" rpy="0 0 0" />
        <mass value="0.8" />
        <inertia ixx="0.008" ixy="0.0" ixz="0.0" iyy="0.008" iyz="0.0" izz="0.008" />
      </inertial>
      <visual>
        <origin xyz="0 0 0.15" rpy="0 0 0" />
        <geometry>
          <cylinder radius="0.03" length="0.30" />
        </geometry>
        <material name="Green" />
      </visual>
      <collision>
        <origin xyz="0 0 0.15" rpy="0 0 0" />
        <geometry>
          <cylinder radius="0.03" length="0.30" />
        </geometry>
      </collision>
    </link>
    <gazebo reference="${prefix}link_1">
      <material>Gazebo/Blue</material>
    </gazebo>

    <!-- Joint 2: Revolute about Y, between link_0 and link_1 -->
    <joint name="${prefix}joint_2" type="revolute">
      <parent link="${prefix}link_0" />
      <child link="${prefix}link_1" />
      <origin xyz="0 0 0.10" rpy="0 0 0" />
      <axis xyz="0 1 0" />
      <limit effort="50.0" velocity="1.0" lower="-3.1416" upper="3.1416" />
    </joint>

    <!-- Link 2 -->
    <link name="${prefix}link_2">
      <inertial>
        <origin xyz="0 0 0.10" rpy="0 0 0" />
        <mass value="0.6" />
        <inertia ixx="0.006" ixy="0.0" ixz="0.0" iyy="0.006" iyz="0.0" izz="0.006" />
      </inertial>
      <visual>
        <origin xyz="0 0 0.10" rpy="0 0 0" />
        <geometry>
          <cylinder radius="0.03" length="0.20" />
        </geometry>
        <material name="Red" />
      </visual>
      <collision>
        <origin xyz="0 0 0.10" rpy="0 0 0" />
        <geometry>
          <cylinder radius="0.03" length="0.20" />
        </geometry>
      </collision>
    </link>
    <gazebo reference="${prefix}link_2">
      <material>Gazebo/Yellow</material>
    </gazebo>

    <!-- Joint 3: Prismatic along Z, between link_1 and link_2 -->
    <joint name="${prefix}joint_3" type="prismatic">
      <parent link="${prefix}link_1" />
      <child link="${prefix}link_2" />
      <origin xyz="0 0 0.30" rpy="0 0 0" />
      <axis xyz="0 0 1" />
      <limit effort="100.0" velocity="0.2" lower="0.0" upper="0.40" />
    </joint>

    <!-- Link 3 -->
    <link name="${prefix}link_3">
      <inertial>
        <origin xyz="0 0 0.10" rpy="0 0 0" />
        <mass value="0.4" />
        <inertia ixx="0.004" ixy="0.0" ixz="0.0" iyy="0.004" iyz="0.0" izz="0.004" />
      </inertial>
      <visual>
        <origin xyz="0 0 0.10" rpy="0 0 0" />
        <geometry>
          <cylinder radius="0.025" length="0.20" />
        </geometry>
        <material name="Gray" />
      </visual>
      <collision>
        <origin xyz="0 0 0.10" rpy="0 0 0" />
        <geometry>
          <cylinder radius="0.025" length="0.20" />
        </geometry>
      </collision>
    </link>
    <gazebo reference="${prefix}link_3">
      <material>Gazebo/Green</material>
    </gazebo>

    <!-- Joint 4: Revolute about Z, between link_2 and link_3 -->
    <joint name="${prefix}joint_4" type="revolute">
      <parent link="${prefix}link_2" />
      <child link="${prefix}link_3" />
      <origin xyz="0 0 0.20" rpy="0 0 0" />
      <axis xyz="0 0 1" />
      <limit effort="50.0" velocity="1.0" lower="-3.1416" upper="3.1416" />
    </joint>

    <!-- Link 4 -->
    <link name="${prefix}link_4">
      <inertial>
        <origin xyz="0 0 0.10" rpy="0 0 0" />
        <mass value="0.3" />
        <inertia ixx="0.003" ixy="0.0" ixz="0.0" iyy="0.003" iyz="0.0" izz="0.003" />
      </inertial>
      <visual>
        <origin xyz="0 0 0.10" rpy="0 0 0" />
        <geometry>
          <cylinder radius="0.025" length="0.20" />
        </geometry>
        <material name="White" />
      </visual>
      <collision>
        <origin xyz="0 0 0.10" rpy="0 0 0" />
        <geometry>
          <cylinder radius="0.025" length="0.20" />
        </geometry>
      </collision>
    </link>
    <gazebo reference="${prefix}link_4">
      <material>Gazebo/Red</material>
    </gazebo>

    <!-- Joint 5: Revolute about Y, between link_3 and link_4 -->
    <joint name="${prefix}joint_5" type="revolute">
      <parent link="${prefix}link_3" />
      <child link="${prefix}link_4" />
      <origin xyz="0 0 0.20" rpy="0 0 0" />
      <axis xyz="0 1 0" />
      <limit effort="50.0" velocity="1.0" lower="-3.1416" upper="3.1416" />
    </joint>

    <!-- Flange Link (Link 5) -->
    <link name="${prefix}link_5">
      <inertial>
        <origin xyz="0 0 0.05" rpy="0 0 0" />
        <mass value="0.2" />
        <inertia ixx="0.002" ixy="0.0" ixz="0.0" iyy="0.002" iyz="0.0" izz="0.002" />
      </inertial>
      <visual>
        <origin xyz="0 0 0.05" rpy="0 0 0" />
        <geometry>
          <cylinder radius="0.02" length="0.10" />
        </geometry>
        <material name="Black" />
      </visual>
      <collision>
        <origin xyz="0 0 0.05" rpy="0 0 0" />
        <geometry>
          <cylinder radius="0.02" length="0.10" />
        </geometry>
      </collision>
    </link>
    <gazebo reference="${prefix}link_5">
      <material>Gazebo/White</material>
    </gazebo>

    <!-- Joint 6: Revolute (wrist), between link_4 and flange -->
    <joint name="${prefix}joint_6" type="revolute">
      <parent link="${prefix}link_4" />
      <child link="${prefix}flange_link" />
      <origin xyz="0 0 0.20" rpy="0 0 0" />
      <axis xyz="0 0 1" />
      <limit effort="30.0" velocity="1.0" lower="-3.1416" upper="3.1416" />
    </joint>

    <!-- Flange Link -->
    <link name="${prefix}flange_link">
      <inertial>
        <origin xyz="0 0 0.025" rpy="0 0 0" />
        <mass value="0.1" />
        <inertia ixx="0.001" ixy="0.0" ixz="0.0" iyy="0.001" iyz="0.0" izz="0.001" />
      </inertial>
      <visual>
        <origin xyz="0 0 0.025" rpy="0 0 0" />
        <geometry>
          <cylinder radius="0.04" length="0.05" />
        </geometry>
        <material name="Cyan" />
      </visual>
      <collision>
        <origin xyz="0 0 0.025" rpy="0 0 0" />
        <geometry>
          <cylinder radius="0.04" length="0.05" />
        </geometry>
      </collision>
    </link>
    <gazebo reference="${prefix}flange_link">
      <material>Gazebo/Gray</material>
    </gazebo>

    <!-- Fixed tool0 link -->
    <link name="${prefix}tool0">
      <inertial>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <mass value="0.01" />
        <inertia ixx="0.0001" ixy="0.0" ixz="0.0" iyy="0.0001" iyz="0.0" izz="0.0001" />
      </inertial>
      <!-- Optional: small visual or collision geometry could be added here -->
    </link>
    <joint name="${prefix}tool0_fixed_joint" type="fixed">
      <parent link="${prefix}flange_link" />
      <child link="${prefix}tool0" />
    </joint>
  </xacro:macro>

</robot>